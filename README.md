# 클라이언트 사이드 로드 밸런싱 (FeignClient와 Ribbon) 실습 레파지토리

<img src="https://teamsparta.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F83c75a39-3aba-4ba4-a792-7aefe4b07895%2F6ea08ada-4daa-44a6-b5ab-fa052e80c455%2FUntitled.png?table=block&id=6607526f-2944-404b-9ece-86477d2b92a0&spaceId=83c75a39-3aba-4ba4-a792-7aefe4b07895&width=770&userId=&cache=v2" alt="Architecture Diagram" width="50%">


유레카 서버 하나에 주문 인스턴스 1개와 같은 기능의 포트만 다른 상품 인스턴스 3개를 연결합니다.
상품을 요청(http://localhost:19091/order/1) 하면 응답하는 인스턴스의 포트를 받아서 노출합니다. 
이를 통해 라운드로빈으로 로드밸런싱이 되는것을 확인합니다.

---
### Run

- 유레카 서버 → order → product(3개 모두) 순으로 실행
- http://localhost:19090/ 으로 접속하면 인스턴스를 확인할 수 있음
- PRODUCT-SERVICE에 포트가 19092,19093,19094 3개가 떠있는것을 확인할 수 있음
    

### 확인

- http://localhost:19091/order/1 에 접속할때마다 텍스트의 포트가 변경되는것을 볼 수 있음 
이를통해 요청마다 라운드로빈으로 동작함을 확인할 수 있음
    
---

## 1.1 클라이언트 사이드 로드 밸런싱 개요

### 1.1.1 로드 밸런싱이란?

- 로드 밸런싱은 네트워크 트래픽을 여러 서버로 분산시켜 서버의 부하를 줄이고, 시스템의 성능과 가용성을 높이는 기술
- 서버 간 트래픽을 고르게 분배하여 특정 서버에 부하가 집중되는 것을 방지
- 종류: 클라이언트 사이드 로드 밸런싱, 서버 사이드 로드 밸런싱

### 1.1.2 클라이언트 사이드 로드 밸런싱이란?

- 클라이언트 사이드 로드 밸런싱은 클라이언트가 직접 여러 서버 중 하나를 선택하여 요청을 보내는 방식
- 클라이언트는 서버의 목록을 가지고 있으며, 이를 바탕으로 로드 밸런싱을 수행

## 1.2 FeignClient 개요

### 1.2.1 FeignClient란?

- FeignClient는 Spring Cloud에서 제공하는 HTTP 클라이언트로, 선언적으로 RESTful 웹 서비스를 호출할 수 있음
- Eureka와 같은 서비스 디스커버리와 연동하여 동적으로 서비스 인스턴스를 조회하고 로드 밸런싱을 수행

### 1.2.2 FeignClient의 주요 특징

- **선언적 HTTP 클라이언트**: 인터페이스와 어노테이션을 사용하여 REST API를 호출할 수 있음
- **Eureka 연동**: Eureka와 통합하여 서비스 인스턴스 목록을 동적으로 조회하고 로드 밸런싱을 수행
- **자동 로드 밸런싱**: Ribbon이 통합되어 있어 자동으로 로드 밸런싱을 수행

## 1.3 Ribbon 개요

### 1.3.1 Ribbon이란?

- 넷플릭스가 개발한 클라이언트 사이드 로드 밸런서로, 마이크로서비스 아키텍처에서 서비스 인스턴스 간의 부하를 분산
- 다양한 로드 밸런싱 알고리즘을 지원하며, Eureka와 같은 서비스 디스커버리와 연동하여 사용

### 1.3.2 Ribbon의 주요 특징

- **서버 리스트 제공자**: Eureka 등으로부터 서비스 인스턴스 리스트를 제공받아 로드 밸런싱에 사용
- **로드 밸런싱 알고리즘**: 라운드 로빈, 가중치 기반 등 다양한 로드 밸런싱 알고리즘 지원
- **Failover**: 요청 실패 시 다른 인스턴스로 자동 전환

## 1.4 로드 밸런싱 알고리즘

### 1.4.1 라운드 로빈

- **라운드 로빈**: 각 서버에 순차적으로 요청을 분배하는 방식
- 간단하고 공평하게 트래픽을 분산

### 1.4.2 가중치 기반 로드 밸런싱

- **가중치 기반 로드 밸런싱**: 각 서버에 가중치를 부여하고, 가중치에 비례하여 요청을 분배하는 방식
- 서버의 성능이나 네트워크 상태에 따라 가중치를 조절

### 1.4.3 기타 알고리즘

- **최소 연결**: 현재 연결된 클라이언트 수가 가장 적은 서버로 요청을 보내는 방식
- **응답 시간 기반**: 서버의 응답 시간을 기준으로 가장 빠른 서버로 요청을 보내는 방식

